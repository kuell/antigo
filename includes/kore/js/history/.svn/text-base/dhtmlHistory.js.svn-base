
window.dhtmlHistory={initialize:function(){if(this.isInternetExplorer()==false){return;}
if(historyStorage.hasKey("DhtmlHistory_pageLoaded")==false){this.fireOnNewListener=false;this.firstLoad=true;historyStorage.put("DhtmlHistory_pageLoaded",true);}else{this.fireOnNewListener=true;this.firstLoad=false;}},addListener:function(_1){this.listener=_1;if(this.fireOnNewListener==true){this.fireHistoryEvent(this.currentLocation);this.fireOnNewListener=false;}},add:function(_2,_3){var _4=this;var _5=function(){if(_4.currentWaitTime>0){_4.currentWaitTime=_4.currentWaitTime-_4.WAIT_TIME;}
_2=_4.removeHash(_2);if(_2){var _6=document.getElementById(_2);if(_6!=undefined||_6!=null){var _7="Exception: History locations can not have "+"the same value as _any_ id's "+"that might be in the document, "+"due to a bug in Internet "+"Explorer; please ask the "+"developer to choose a history "+"location that does not match "+"any HTML id's in this "+"document. The following ID "+"is already taken and can not "+"be a location: "+_2;throw _7;}}
historyStorage.put(_2,_3);_4.ignoreLocationChange=true;this.ieAtomicLocationChange=true;_4.currentLocation=_2;if(_2==""&&Kore.is.mozilla){window.location.href=window.location.href.replace(/#?.*$/,"#");}else{window.location.hash=_2;}
if(_4.isInternetExplorer()){_4.iframe.src=_4.pathToBlank+"?"+_2;}
this.ieAtomicLocationChange=false;};window.setTimeout(_5,this.currentWaitTime);this.currentWaitTime=this.currentWaitTime+this.WAIT_TIME;},isFirstLoad:function(){if(this.firstLoad==true){return true;}else{return false;}},isInternational:function(){return false;},getVersion:function(){return"0.05";},getCurrentLocation:function(){var _8=this.removeHash(window.location.hash);return _8;},currentLocation:null,listener:null,iframe:null,ignoreLocationChange:null,WAIT_TIME:200,currentWaitTime:0,fireOnNewListener:null,firstLoad:null,ieAtomicLocationChange:null,create:function(_9){this.pathToBlank=_9||"blank.html";var _a=this.getCurrentLocation();this.currentLocation=_a;if(this.isInternetExplorer()){var _b="<iframe style=\"border: 0px; width: 0px; "+"height: 0px; position: absolute; bottom: 0px; "+"right: 0px; visibility: visible;\" "+"name=\"DhtmlHistoryFrame\" id=\"DhtmlHistoryFrame\" "+"src=\""+this.pathToBlank+"?"+_a+"\">"+"</iframe>";if(document.body){var _c=document.createElement("span");_c.innerHTML=_b;document.body.insertBefore(_c.firstChild,document.body.firstChild);}else{document.write(_b);}
this.iframe=document.getElementById("DhtmlHistoryFrame");this.WAIT_TIME=400;}
var _d=this;window.onunload=function(){_d.firstLoad=null;};if(this.isInternetExplorer()==false){if(historyStorage.hasKey("DhtmlHistory_pageLoaded")==false){this.ignoreLocationChange=true;this.firstLoad=true;historyStorage.put("DhtmlHistory_pageLoaded",true);}else{this.ignoreLocationChange=false;this.fireOnNewListener=true;}}else{this.ignoreLocationChange=true;}
var _d=this;var _e=function(){_d.checkLocation();};setInterval(_e,100);},fireHistoryEvent:function(_f){var _10=historyStorage.get(_f);if(_10){try{eval(_10[0]+"(\""+_f+"\", \""+_10[1]+"\")");}
catch(e){alert("Error executing '"+_10[0]+"(\""+_f+"\", \""+_10[1]+"\")"+"': \n"+e.message);}}
if(this.listener){this.listener.call(null,_f,_10);}},checkLocation:function(){if(this.isInternetExplorer()==false&&this.ignoreLocationChange==true){this.ignoreLocationChange=false;return;}
if(this.isInternetExplorer()==false&&this.ieAtomicLocationChange==true){return;}
var _11=this.getCurrentLocation();if(_11==this.currentLocation){return;}
this.ieAtomicLocationChange=true;if(this.isInternetExplorer()&&this.getIFrameHash()!=_11){this.iframe.src=this.pathToBlank+"?"+_11;}else{if(this.isInternetExplorer()){return;}}
this.currentLocation=_11;this.ieAtomicLocationChange=false;this.fireHistoryEvent(_11);},getIFrameHash:function(){var _12=document.getElementById("DhtmlHistoryFrame");var doc=_12.contentWindow.document;var _14=new String(doc.location.search);if(_14.length==1&&_14.charAt(0)=="?"){_14="";}else{if(_14.length>=2&&_14.charAt(0)=="?"){_14=_14.substring(1);}}
return _14;},removeHash:function(_15){if(_15==null||_15==undefined){return null;}else{if(_15==""){return"";}else{if(_15.length==1&&_15.charAt(0)=="#"){return"";}else{if(_15.length>1&&_15.charAt(0)=="#"){return _15.substring(1);}else{return _15;}}}}},iframeLoaded:function(_16){if(this.ignoreLocationChange==true){this.ignoreLocationChange=false;return;}
var _17=new String(_16.search);if(_17.length==1&&_17.charAt(0)=="?"){_17="";}else{if(_17.length>=2&&_17.charAt(0)=="?"){_17=_17.substring(1);}}
if(this.pageLoadEvent!=true){window.location.hash=_17;}
this.fireHistoryEvent(_17);},isInternetExplorer:function(){var _18=navigator.userAgent.toLowerCase();if(document.all&&_18.indexOf("msie")!=-1&&_18.indexOf("opera")==-1){return true;}else{return false;}}};window.historyStorage={debugging:false,storageHash:new Object(),hashLoaded:false,put:function(key,_1a){if(!/^ktnotempty_/.test(key)){key="ktnotempty_"+key;}
this.assertValidKey(key);if(this.hasKey(key)){this.remove(key);}
this.storageHash[key]=_1a;this.saveHashTable();},get:function(key){if(!/^ktnotempty_/.test(key)){key="ktnotempty_"+key;}
this.assertValidKey(key);this.loadHashTable();var _1c=this.storageHash[key];if(_1c==undefined){return null;}else{return _1c;}},remove:function(key){if(!/^ktnotempty_/.test(key)){key="ktnotempty_"+key;}
this.assertValidKey(key);this.loadHashTable();delete this.storageHash[key];this.saveHashTable();},reset:function(){if(this.storageField){this.storageField.value="";}
this.storageHash=new Object();},hasKey:function(key){if(!/^ktnotempty_/.test(key)){key="ktnotempty_"+key;}
this.assertValidKey(key);this.loadHashTable();if(typeof this.storageHash[key]=="undefined"){return false;}else{return true;}},isValidKey:function(key){return(typeof key=="string");},storageField:null,init:function(){var _20="<form id=\"historyStorageForm\" method=\"get\" style=\"position: absolute; top: -1000px; left: -1000px; display: none;\"><TEXTAREA id=\"historyStorageField\" name=\"historyStorageField\"></textarea></form>";if(document.body){var _21=document.createElement("span");_21.innerHTML=_20;document.body.insertBefore(_21.firstChild,document.body.firstChild);}else{document.write(_20);}
this.storageField=document.getElementById("historyStorageField");},assertValidKey:function(key){if(this.isValidKey(key)==false){throw"Please provide a valid key for "+"window.historyStorage, key= "+key;}},loadHashTable:function(){if(this.hashLoaded==false){var _23=this.storageField?this.storageField.value:"";if(_23!=""&&_23!=null){this.storageHash=eval("("+_23+")");}
this.hashLoaded=true;}},saveHashTable:function(){this.loadHashTable();var _24=JSON.stringify(this.storageHash);if(this.storageField){this.storageField.value=_24;}}};